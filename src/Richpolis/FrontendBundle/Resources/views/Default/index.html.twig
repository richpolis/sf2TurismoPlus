{% extends 'FrontendBundle::layout.html.twig' %}

{% set paginaGalerias = pagina.galerias %}
{% if paginaGalerias[0] is defined %}    
    {% set fondo1 = (paginaGalerias[0].webPath | apply_filter('inicio_carrusel') )%}
{% else %}
    {% set fondo1 = 'http://placehold.it/1025x537&text=1' %}
{% endif %}

{% if paginaGalerias[1] is defined %}    
    {% set fondo2 = (paginaGalerias[1].webPath | apply_filter('inicio_carrusel')) %}
{% else %}
    {% set fondo2 = 'http://placehold.it/1025x537&text=2' %}
{% endif %} 
    
{% if paginaGalerias[2] is defined %}    
    {% set fondo3 = (paginaGalerias[2].webPath | apply_filter('inicio_carrusel')) %}
{% else %}
    {% set fondo3 = 'http://placehold.it/1025x537&text=3' %}
{% endif %} 
    
{% if paginaGalerias[3] is defined %}    
    {% set fondo4 = (paginaGalerias[3].webPath | apply_filter('inicio_carrusel')) %}
{% else %}
    {% set fondo4 = 'http://placehold.it/1025x537&text=4' %}
{% endif %}     

{% block stylesheets %}
    {{  parent()  }}
    <link rel="stylesheet" href="{{asset('css/jquery.bxslider.css')}}">
    <link rel="stylesheet" href="{{asset('css/fancybox/jquery.fancybox.css')}}"/>
    <style>
    .bx-wrapper .bx-viewport{
        padding: 0px;
        border: none;
        top: 0px;
        left: 0px;
    }
    @-moz-keyframes autobusesInicio {
    0% {
      background: url("{{fondo1}}") no-repeat top center;
    }

    25% {
      background: url("{{fondo2}}") no-repeat top center;
    }

    50% {
      background: url("{{fondo3}}") no-repeat top center;
    }

    75% {
      background: url("{{fondo4}}") no-repeat top center;
    }

    100% {
      background: url("{{fondo1}}") no-repeat top center;
    }
  }
  @-webkit-keyframes autobusesInicio {
    0% {
      background: url("{{fondo1}}") no-repeat top center;
    }

    25% {
      background: url("{{fondo2}}") no-repeat top center;
    }

    50% {
      background: url("{{fondo3}}") no-repeat top center;
    }

    75% {
      background: url("{{fondo4}}") no-repeat top center;
    }

    100% {
      background: url("{{fondo1}}") no-repeat top center;
    }
  }
  @-o-keyframes autobusesInicio {
    0% {
      background: url("{{fondo1}}") no-repeat top center;
    }

    25% {
      background: url("{{fondo2}}") no-repeat top center;
    }

    50% {
      background: url("{{fondo3}}") no-repeat top center;
    }

    75% {
      background: url("{{fondo4}}") no-repeat top center;
    }

    100% {
      background: url("{{fondo1}}") no-repeat top center;
    }
  }
  @-ms-keyframes autobusesInicio {
    0% {
      background: url("{{fondo1}}") no-repeat top center;
    }

    25% {
      background: url("{{fondo2}}") no-repeat top center;
    }

    50% {
      background: url("{{fondo3}}") no-repeat top center;
    }

    75% {
      background: url("{{fondo4}}") no-repeat top center;
    }

    100% {
      background: url("{{fondo1}}") no-repeat top center;
    }
  }
  @keyframes autobusesInicio {
    0% {
      background: url("{{fondo1}}") no-repeat top center;
    }

    25% {
      background: url("{{fondo2}}") no-repeat top center;
    }

    50% {
      background: url("{{fondo3}}") no-repeat top center;
    }

    75% {
      background: url("{{fondo4}}") no-repeat top center;
    }

    100% {
      background: url("{{fondo1}}") no-repeat top center;
    }
  }

    </style>
{% endblock %}

{% block header_class 'inicio' %}

{% block contenido %}
            <div class="cotizador-promociones">
                <div class="cotizador-linea">
                    <a href="{{path('frontend_cotizador')}}" style="color: white;">
                        {{"Visite nuestro cotizador en linea"|trans}}
                    </a>
                </div>
                <div class="newsletter">
                    {{"Reciba ofertas y promociones en su correo"|trans}}
                    <span class="newsletter-correo">
                        <a href="#" data-toggle="modal" data-target="#formNewsletter" class="newsletter">   
                        </a>    
                    </span>
                </div>
            </div>
            <article class="destinos-eventos">
                <div class="destinos">
                    <span class="titulo">{{"destinos"|trans}}</span>
                    <ul class="sliderDestinos">
                        {% for categoria in categoriasPublicacion if categoria.slug == "destinos" %}
                            {% for publicacion in categoria.publicaciones %}
                            <li class="image-large">
                                <a href="{{publicacion.webPath}}" class="fancybox image-wrap">
                                    <img src="{{ publicacion.webPath | apply_filter('publicaciones_carrusel')  }}" title="{{ publicacion.titulo(locale)}}">
                                    <span class="lupa"></span>
                                </a>
                            </li>
                            {% endfor %}
                        {% endfor %}
                    </ul>
                </div>
                <div class="eventos">
                    <span class="titulo">{{"eventos"|trans}}</span>
                    <ul class="sliderEventos">
                        {% for categoria in categoriasPublicacion if categoria.slug == "eventos" %}
                            {% for publicacion in categoria.publicaciones %}
                            <li class="image-large">
                                <a href="{{publicacion.webPath}}" class="fancybox image-wrap">
                                    <img src="{{ publicacion.webPath | apply_filter('publicaciones_carrusel')  }}" title="{{ publicacion.titulo(locale  )}}">
                                    <span class="lupa"></span>
                                </a>
                            </li>
                            {% endfor %}
                        {% endfor %}
                    </ul>
                </div>
            </article>
            <article class="twitters">
                {{ render(controller("FrontendBundle:Default:lastTweets",{'username': 'TurismoPlusMG'})) }}
                <div class="experiencias">
                    <span class="titulo-experiencias">{{"Experiencias MG"|trans}}</span>
                    <div class="contenedor-experiencias">
                        {% set experiencia = experiencias[0] %}
                        <div class="experiencia  active ">
                            <!--p class="contenido-experiencia"-->
                                {{experiencia.contenido(locale) | raw }}
                            <!--/p-->
                            <span class="autor-experiencia">
                                -{{experiencia.autor}}
                            </span>
                        </div>

                    </div>
                </div>
            </article>
<!-- Modal -->
<div class="modal fade" id="formNewsletter" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        {% include 'FrontendBundle:Default:formNewsletter.html.twig' with {'form': form}%}
    </div>    
</div>                                
                                
{% endblock %}
{% block javascripts %}
{{ parent() }}
<script src="{{asset('js/jquery.bxslider.js')}}"></script>
<script src="{{asset('js/main.js')}}"></script>
<script src="{{asset('js/fancybox/jquery.fancybox.pack.js')}}"></script>
<script src="{{asset('js/fancybox/jquery.fancybox-media.js')}}"></script>
<script>
$(document).on("ready",function(){
        setTimeout(function(){
            iniciarCircle();
        },6000);

        $('.sliderDestinos,.sliderEventos').bxSlider({
            captions: true,
            randomStart: false,
            pager: false,
            auto: true,
            controls: false,
            speed: 1000,
        });
        
        $("a.fancybox").fancybox();
                
        $("a.fancybox-media").fancybox({
            helpers : {
                media: true
            },
            youtube : {
                autoplay: 0
            }
        });
        iniciarlizarFormNewsletter();

});
var iniciarCircle=function(){
        $('ul.twitter-feed li:first-child').slideUp("slow",function(){
            $('ul.twitter-feed').append($(this).slideDown("fast"));
        });
                 
        setTimeout(function(){
            iniciarCircle();
        },6000);
                    
}
function iniciarlizarFormNewsletter(){
    $("input.form-submit").click( function() {
        debugger;
        $('img.ajax-loader').css({visibility: 'visible'});
        $("img.ajax-loader").fadeIn("fast",function(){
            $.post("{{path('frontend_form_newsletter')}}",
            $("form.form-newsletter").serialize(),
            function(data){
                actualizaFormularioNewsletter(data);
                setTimeout(function(){
                    $("#formulario_newsletter").find(".form-response-output").fadeOut("fast");
                },2000);
                
            });    
        });
    });
}

function actualizaFormularioNewsletter(data){
  $("#formulario_newsletter").parent().html(data);
  iniciarlizarFormNewsletter();
}
    
</script>
{% endblock %}

